!function(e){"use strict";!function(t,a){function n({baseUrl:t}){const[a]=e.React.useState(()=>{const a=new e.QueryClient({defaultOptions:{queries:{staleTime:3e5,gcTime:6e5,retry:1}}});return new e.DkanClient({baseUrl:t,queryClient:a})});return e.React.createElement(e.DkanClientProvider,{client:a},e.React.createElement(c,null))}function c(){const[t,a]=e.React.useState(""),[n,c]=e.React.useState(1),[d,m]=e.React.useState(null),{data:u,isLoading:R,isError:E,error:g}=e.useDatasetSearch({searchOptions:{fulltext:t||void 0,page:n,"page-size":10},enabled:!0}),p=u?.results||[],v=u?.total||0,N=Math.ceil(v/10);return e.React.createElement("div",{className:"dkan-widget-container"},e.React.createElement(l,null),e.React.createElement("div",{className:"dkan-widget-body"},e.React.createElement(s,{value:t,onChange:e=>{a(e.target.value),c(1),m(null)}}),R&&e.React.createElement(r,null),E&&e.React.createElement(i,{message:g?.message}),!R&&!E&&e.React.createElement(o,{datasets:p,totalResults:v,page:n,totalPages:N,expandedCard:d,onToggleCard:e=>{m(d===e?null:e)},onPrevPage:()=>{n>1&&(c(n-1),m(null))},onNextPage:()=>{n<N&&(c(n+1),m(null))}})))}function l(){return e.React.createElement("header",{className:"dkan-widget-header"},e.React.createElement("h2",null,"DKAN Dataset Search (React)"),e.React.createElement("p",null,"Demonstrating @dkan-client-tools/react in Drupal"))}function s({value:t,onChange:a}){return e.React.createElement("div",{className:"search-box"},e.React.createElement("input",{type:"text",className:"search-input",placeholder:"Search datasets...",value:t,onChange:a}))}function r(){return e.React.createElement("div",{className:"loading"},"Loading datasets...")}function i({message:t}){return e.React.createElement("div",{className:"error"},"Error: ",t)}function o({datasets:t,totalResults:a,page:n,totalPages:c,expandedCard:l,onToggleCard:s,onPrevPage:r,onNextPage:i}){return 0===t.length?e.React.createElement("div",{className:"results"},e.React.createElement("div",{className:"no-results"},"No datasets found.")):e.React.createElement("div",{className:"results"},e.React.createElement("div",{className:"results-info"},"Found ",a," datasets (Page ",n," of ",c||1,")"),e.React.createElement("div",{className:"dataset-items"},t.map(t=>e.React.createElement(d,{key:t.identifier,dataset:t,isExpanded:l===t.identifier,onToggle:()=>s(t.identifier)}))),c>1&&e.React.createElement(R,{page:n,totalPages:c,onPrevPage:r,onNextPage:i}))}function d({dataset:t,isExpanded:a,onToggle:n}){const c=t.description||"",l=c.substring(0,200)+(c.length>200?"...":"");return e.React.createElement("div",{className:"dataset-card "+(a?"expanded":""),onClick:n},e.React.createElement("div",{className:"card-header"},e.React.createElement("h3",null,t.title),e.React.createElement("span",{className:"expand-icon"},a?"âˆ’":"+")),c&&e.React.createElement("p",{className:"description"},a?c:l),e.React.createElement("div",{className:"metadata"},e.React.createElement("span",{className:"tag"},t.accessLevel),t.modified&&e.React.createElement("span",{className:"modified"},"Modified: ",new Date(t.modified).toLocaleDateString())),t.keyword&&t.keyword.length>0&&e.React.createElement("div",{className:"keywords"},t.keyword.map((t,a)=>e.React.createElement("span",{key:a,className:"keyword"},t))),a&&e.React.createElement(m,{dataset:t}))}function m({dataset:t}){return e.React.createElement("div",{className:"expanded-details"},t.identifier&&e.React.createElement(u,{label:"Identifier",value:t.identifier}),t.publisher&&e.React.createElement(u,{label:"Publisher",value:t.publisher.name}),t.theme&&t.theme.length>0&&e.React.createElement(u,{label:"Theme",value:t.theme.join(", ")}),t.issued&&e.React.createElement(u,{label:"Issued",value:new Date(t.issued).toLocaleDateString()}),t.contactPoint&&e.React.createElement(u,{label:"Contact",value:`${t.contactPoint.fn}${t.contactPoint.hasEmail?` (${t.contactPoint.hasEmail.replace("mailto:","")})`:""}`}),t.distribution&&t.distribution.length>0&&e.React.createElement("div",{className:"detail-row"},e.React.createElement("strong",null,"Distributions:"),e.React.createElement("div",{className:"distributions"},t.distribution.map((t,a)=>e.React.createElement("div",{key:a,className:"distribution-item"},e.React.createElement("span",{className:"distribution-title"},t.title||`Distribution ${a+1}`),t.format&&e.React.createElement("span",{className:"distribution-format"},t.format))))),t.license&&e.React.createElement("div",{className:"detail-row"},e.React.createElement("strong",null,"License:"),e.React.createElement("a",{href:t.license,target:"_blank",rel:"noopener noreferrer"},t.license)))}function u({label:t,value:a}){return e.React.createElement("div",{className:"detail-row"},e.React.createElement("strong",null,t,":"),e.React.createElement("span",null,a))}function R({page:t,totalPages:a,onPrevPage:n,onNextPage:c}){return e.React.createElement("div",{className:"pagination"},e.React.createElement("button",{className:"prev-btn",disabled:1===t,onClick:n},"Previous"),e.React.createElement("span",{className:"page-info"},"Page ",t," of ",a),e.React.createElement("button",{className:"next-btn",disabled:t===a,onClick:c},"Next"))}t.behaviors.dkanReactDatasetSearchWidget={attach(t,c){a("dkan-react-dataset-search","#dkan-react-dataset-search-widget",t).forEach(t=>{const a=(c.dkanClientDemoReact||{}).baseUrl||"/";e.ReactDOM.createRoot(t).render(e.React.createElement(n,{baseUrl:a}))})}}}(window.Drupal,window.once)}(DkanClientToolsReact);
//# sourceMappingURL=dataset-search-widget.min.js.map
